!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);class i{constructor(t,e){this.x=t,this.y=e}static fromPolar(t,e,s=e){const i=e*Math.cos(t),n=s*Math.sin(t);return new this(Math.floor(i),Math.floor(n))}static add(t,e){return new this(t.x+e.x,t.y+e.y)}static sub(t,e){return new this(t.x-e.x,t.y-e.y)}static eq(t,e){return t.x===e.x&&t.y===e.y}add(t){return this.x+=t.x,this.y+=t.y,this}addX(t){return this.x+=t,this}addY(t){return this.y+=t,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subX(t){return this.x-=t,this}subY(t){return this.y-=t,this}mul(t){return this.x=this.x*t,this.y=this.y*t,this}div(t){if(0!==t)return this.x=this.x/t,this.y=this.y/t,this}get magnitude(){return Math.hypot(this.x,this.y)}normalize(){const t=this.getMagnitude();return this.div(t),this}getDistance(t){const e=t.x-this.x,s=t.y-this.y;return Math.hypot(e,s)}getAngle(t){return Math.atan2(t.y-this.y,t.x-this.x)}eq(t){return this.x===t.x&&this.y===t.y}quasiEq(t){return Math.abs(this.x-t.x)<=1&&this.y===t.y||this.x===t.x&&Math.abs(this.y-t.y)<=1}copy(){return new i(this.x,this.y)}}class n{constructor({angleVel:t,center:e,radiusX:s,radiusY:i,layerNum:n,modifiers:r}){this.angleVel=t,this.center=e,this.radiusX=s,this.radiusY=i,this.layerNum=n,this.modifiers=r,this.outlinePointsNum=Math.floor(2*Math.PI/t),this.outline,this.setOutline()}setOutline(){this.outline=Array.from({length:this.outlinePointsNum},(t,e)=>{const s=this.angleVel*e,n=this.modifiers.modifyEllipseRadius(this.radiusX,s,e,this.layerNum),r=this.modifiers.modifyEllipseRadius(this.radiusY,s,e,this.layerNum),a=i.fromPolar(s,n,r).add(this.center);return this.modifiers.modifyOutlinePoint(a,this.radiusX,s,e,this.layerNum)})}update({radiusX:t,radiusY:e}){this.radiusX=t,this.radiusY=e,this.setOutline()}plot(t,e=0){t.strokeStyle=this.modifiers.setColor(e),t.lineWidth=this.modifiers.setLineWidth(e),t.beginPath(),t.moveTo(this.outline[0].x,this.outline[0].y),this.outline.forEach(e=>{t.lineTo(e.x,e.y)}),t.lineTo(this.outline[0].x,this.outline[0].y),t.stroke()}}class r{constructor({center:t,radius:e,layersNum:s,angleVel:i,modifiers:n}){this.radiusX=e.x,this.radiusY=e.y,this.center=t,this.angleVel=i,this.modifiers=n,this.layersNum=s,this.origLayerNum=s,this.sep=2*this.radiusY/this.layersNum,this.layers=this.setLayers()}setLayers(){return Array.from({length:this.layersNum},(t,e)=>{const s=this.getLayerRadius(e);return new n({angleVel:this.angleVel,center:new i(this.center.x,this.center.y+this.radiusY-e*this.sep),radiusX:s,radiusY:s*this.modifiers.modifySmallRadius(e),layerNum:e,modifiers:this.modifiers})})}getLayerRadius(t){const e=Math.PI/this.layersNum*t,s=i.fromPolar(e,this.radiusY,this.radiusX).sub(new i(this.radiusY-t*this.sep,0)).magnitude;return this.modifiers.modifyLayerRadius(s,e,t)}recalculateParams(){this.sep=2*this.radiusY/this.layersNum,this.layers=this.setLayers(),this.modifiers.layersNum=this.layersNum}update({plotting:t=!1,ctx:e,setColor:s,setLineWidth:i}={}){this.layerNum!==this.origLayerNum&&this.recalculateParams(),this.layers.forEach((s,i)=>{const n=this.getLayerRadius(i);s.update({radiusX:n,radiusY:n*this.modifiers.modifySmallRadius(i)}),t&&s.plot(e,i)})}}class a{constructor({type:t="sin",A:e,B:s,C:i=0,D:n=0,maxR:r=0}){this.type=t,this.A=e,this.B=s,this.C=i,this.D=n,this.maxR=r,this.orig={A:e,B:s,C:i,D:n}}getPoint(t){return this.A*Math[this.type](this.B*t+this.C)+this.D}scaleA(t){this.A=this.orig.A*t/this.maxR}reset(...t){t.length>0?t.forEach(t=>this[t]=this.orig[t]):({A:this.A,B:this.B,C:this.C,D:this.D}=this.orig)}}class h{constructor(t){this.waves=t.waves.map(e=>new a(Object.assign(e,{maxR:t.sphere.radius.x}))),this.layersNum=t.sphere.layersNum,this.hue=t.modifiers.hue,this.nsIncr=t.modifiers.nsIncrements,this.ns=[0,0,0]}update(){this.ns=this.ns.map((t,e)=>t+this.nsIncr[e]),this.waves[0].C+=this.nsIncr[0]}modifySmallRadius(){return.8}modifyLayerRadius(t,e,s){return this.waves[1].reset(),this.waves[1].scaleA(t),this.waves[1].C+=e*Math.sin(this.ns[1]),t+this.waves[1].getPoint(e)}modifyEllipseRadius(t,e,s,i){return this.waves[0].reset("A","B"),this.waves[0].scaleA(t),t+this.waves[0].getPoint(e)}modifyOutlinePoint(t,e,s,n,r){return this.waves[2].reset(),this.waves[2].scaleA(e),this.waves[2].C+=.01*r*Math.sin(this.ns[2]),t.add(new i(this.waves[2].getPoint(s),this.waves[2].getPoint(.1*n)))}setColor(t){return`hsl(${this.hue+t}, 60%, 70%)`}setLineWidth(t){return t/this.layersNum}}function o(t,e){const s=document.createElementNS("http://www.w3.org/2000/svg",t);return Object.entries(e).forEach(t=>{s.setAttribute(t[0],t[1])}),s}class d{constructor({scope:t,shouldDraw:e=!0,shouldUpdate:s=!0,hasMenuBtn:i=!0,githubUrl:n}){this.scope=t,this.shouldUpdate=s,this.shouldDraw=e,this.hasMenuBtn=i,this.githubUrl=n,this.reset(),this.menu=Object.assign(document.createElement("div"),{id:"ui"}),this.render(),this.eventListener()}reset(){const t=document.querySelector("#ui");if(t&&t.parentNode.removeChild(t),this.hasMenuBtn){const t=document.querySelector("#menu");t&&t.parentNode.removeChild(t)}}addSeparator(){const t=document.createElement("hr");this.menu.appendChild(t)}addSignature(){const t=Object.assign(document.createElement("a"),{href:"//joseblancoperales.com",target:"_blank",id:"signature"});t.innerHTML='by<svg width="50" height="50" version="1.1" viewBox="0 0 13.229166 13.229167" xmlns="http://www.w3.org/2000/svg"><g id="logo-body" fill="#800000"><path d="m6.6152 0.023438c-3.6369 0-6.5918 2.9548-6.5918 6.5918 0 3.6369 2.9548 6.5898 6.5918 6.5898 3.6369 0 6.5898-2.9529 6.5898-6.5898 0-3.6369-2.9529-6.5918-6.5898-6.5918zm0 0.50781c3.363 0 6.084 2.721 6.084 6.084s-2.721 6.084-6.084 6.084-6.084-2.721-6.084-6.084 2.721-6.084 6.084-6.084z" color="#000000" color-rendering="auto" dominant-baseline="auto" image-rendering="auto" shape-rendering="auto" solid-color="#000000" style="font-feature-settings:normal;font-variant-alternates:normal;font-variant-caps:normal;font-variant-ligatures:normal;font-variant-numeric:normal;font-variant-position:normal;isolation:auto;mix-blend-mode:normal;paint-order:normal;shape-padding:0;text-decoration-color:#000000;text-decoration-line:none;text-decoration-style:solid;text-indent:0;text-orientation:mixed;text-transform:none;white-space:normal"/><g transform="translate(-.19844 .19844)"><path d="m8.1166 5.4546v5.6823c1.5655-0.0045 2.8332-1.2747 2.8332-2.8411 0-1.5665-1.2678-2.8369-2.8332-2.8411z"/><path d="m8.1204 1.6954v3.2544c0.89579-0.00377 1.6209-0.7306 1.6209-1.6272 0-0.89658-0.72514-1.6238-1.6209-1.6272z"/><path d="m5.8204 1.6958v6.996a0.81365 0.81365 0 0 1 -0.8137 0.8137 0.81365 0.81365 0 0 1 -0.8137 -0.8137l-1.5168 0.72437a2.4409 2.4409 0 0 0 2.3305 1.7167 2.4409 2.4409 0 0 0 2.4411 -2.4411v-6.996z" style="paint-order:normal"/></g></g></svg>';const e=Object.assign(document.createElement("a"),{href:this.githubUrl,target:"_blank",id:"github-link"});e.textContent="github",this.menu.appendChild(t),this.menu.appendChild(e)}render(){if(this.hasMenuBtn){this.svg=o("svg",{width:45,height:45,id:"menu"});const t=o("rect",{x:10,y:10,width:25,height:5,fill:"#000"});this.svg.appendChild(t);const e=o("rect",{x:10,y:20,width:25,height:5,fill:"#000"});this.svg.appendChild(e);const s=o("rect",{x:10,y:30,width:25,height:5,fill:"#000"});this.svg.appendChild(s),document.body.appendChild(this.svg),this.menu.classList.add("moverIzq"),this.closeBtn=Object.assign(document.createElement("button"),{textContent:"[ close ]",id:"close"}),this.menu.appendChild(this.closeBtn)}document.body.appendChild(this.menu)}eventListener(){this.hasMenuBtn&&this.svg.addEventListener("click",this.openEventHandler.bind(this),{once:!0}),this.menu.addEventListener("change",this.updateEventhandler.bind(this)),this.menu.addEventListener("click",this.updateEventhandler.bind(this))}openEventHandler(t){this.menu.classList.remove("moverIzq"),this.closeBtn.addEventListener("click",this.closeEventHandler.bind(this),{once:!0})}closeEventHandler(t){this.menu.classList.add("moverIzq"),t.stopPropagation(),this.svg.addEventListener("click",this.openEventHandler.bind(this),{once:!0})}updateEventhandler(t){("change"===t.type&&("range"===t.target.type||"SELECT"===t.target.tagName)||"click"===t.type&&"BUTTON"===t.target.nodeName)&&(this.shouldUpdate&&this.scope.update(),this.shouldDraw&&this.scope.draw())}}class l{constructor({text:t,scope:e,prop:s}){this.scope=e,this.prop=s,this.btn=Object.assign(document.createElement("button"),{textContent:t}),this.render(),this.eventListener()}render(){document.querySelector("#ui").appendChild(this.btn)}eventListener(){this.btn.addEventListener("click",this.eventHandler.bind(this))}eventHandler(t){const e=this.scope[this.prop],s=document.createElement("a");s.style="display: none;",s.download=e.startsWith("data:image")?"img.png":"img.json",s.href=e,document.body.appendChild(s),s.click(),s.parentNode.removeChild(s)}}class u{constructor({playText:t,stopText:e,scope:s}){this.playText=t,this.stopText=e,this.animate=function(t,e=0){let s,i=!1;const n=function(t){let e=0,s=0;const i=t;return t=>{let n=t-e;if(e=t,(s+=n)>i)return s=0,!0}}(e),r=t=>{i||(i=!0),s=window.requestAnimationFrame(h)},a=t=>{s&&(window.cancelAnimationFrame(s),s=void 0,i=!1)},h=(e=0)=>{n(e)&&t(),r()};return{start:r,stop:a,toggle:t=>{(i=!i)?r():a()},get animating(){return i}}}(t=>{s.draw(),s.update()}),this.btn=Object.assign(document.createElement("button"),{textContent:t,id:"play"}),this.btn.classList.add("toggle"),this.render(),this.eventListener()}render(){document.querySelector("#ui").appendChild(this.btn)}eventListener(){this.btn.addEventListener("click",this.eventHandler.bind(this))}eventHandler(t){this.animate.toggle(),this.btn.classList.toggle("deactivated"),this.btn.textContent=this.animate.animating?this.stopText:this.playText,t.stopPropagation()}}class c{constructor({max:t,min:e,step:s=1,scope:i,prop:n,label:r}){this.scope=i,this.prop=n,this.label=r||n,this.slider=Object.assign(document.createElement("input"),{type:"range",id:this.label.replace(/\s/g,"-"),max:t,min:e,step:s}),this.slider.value=i[n],this.output=document.createElement("output"),this.output.textContent=i[n],this.render(),this.eventListener()}render(){const t=document.querySelector("#ui"),e=document.createDocumentFragment(),s=document.createElement("div");s.classList.add("slider");const i=Object.assign(document.createElement("label"),{textContent:`${this.label} — `,for:this.slider.id}),n=document.createElement("br");e.appendChild(s),s.appendChild(i),s.appendChild(this.output),s.appendChild(n),s.appendChild(this.slider),t.appendChild(e)}eventListener(){this.slider.addEventListener("input",this.eventHandler.bind(this))}eventHandler(t){const e=this.slider.valueAsNumber;this.output.textContent=e,this.scope[this.prop]=e}}class m{constructor(t,e){this.title=t,this.text=e,this.render()}render(){const t=document.querySelector("#ui"),e=document.createElement("div");e.id="description";const s=document.createElement("h1");s.textContent=this.title,e.appendChild(s),this.text.forEach(t=>{const s=document.createElement("p");s.textContent=t,e.appendChild(s)}),t.appendChild(e)}}class p{constructor(t){this.ctx=t}init(t){this.backgroundColor=t.backgroundColor,this.modifiers=new h(t),this.sphere=new r({center:new i(this.ctx.canvas.width/2,this.ctx.canvas.height/2),radius:new i(t.sphere.radius.x,t.sphere.radius.y),layersNum:t.sphere.layersNum,angleVel:t.sphere.angleVel,modifiers:this.modifiers}),this.setBindings(t.sliders),this.draw()}setBindings(t){this.menu=new d({scope:this,shouldUpdate:!1,githubUrl:"//github.com/jblanper/sine-globe"}),this.description=new m("Sine-globe",["Blob formed by ellipses made of sine waves.",'Press "play" to begin the animation. Every "wave" frequency and amplitude             can be tweaked. The last slider changes the hue. Enjoy!']),this.menu.addSeparator(),this.playBtn=new u({playText:"play",stopText:"stop",scope:this}),this.getImgBtn=new l({text:"get IMG",scope:this,prop:"png"}),this.menu.addSeparator(),this.sliders=[],this.sliders.push(new c({label:"number of layers",prop:"layersNum",scope:this.sphere,max:t.layersNum.max,min:t.layersNum.min})),this.menu.addSeparator(),this.modifiers.waves.forEach((e,s)=>{this.sliders.push(new c({label:`Wave ${s} amp`,prop:"A",scope:this.modifiers.waves[s].orig,max:t.waveA.max,min:t.waveA.min,step:t.waveA.step})),this.sliders.push(new c({label:`Wave ${s} freq`,prop:"B",scope:this.modifiers.waves[s].orig,max:t.waveB.max,min:t.waveB.min,step:t.waveB.step})),this.sliders.push(new c({label:`Wave ${s} N incr`,prop:s,scope:this.modifiers.nsIncr,max:t.nIncr.max,min:t.nIncr.min,step:t.nIncr.step})),this.menu.addSeparator()}),this.sliders.push(new c({prop:"hue",scope:this.modifiers,max:t.hue.max,min:t.hue.min,step:t.hue.step})),this.menu.addSignature()}get png(){const t=Object.assign(document.createElement("canvas"),{width:this.ctx.canvas.width,height:this.ctx.canvas.height}).getContext("2d");return t.drawImage(this.ctx.canvas,0,0),t.canvas.toDataURL("image/png")}clear(){this.ctx.fillStyle=this.backgroundColor,this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}draw(){this.clear(),this.sphere.update({plotting:!0,ctx:this.ctx})}update(){this.modifiers.update()}}const g={backgroundColor:"#000",sphere:{radius:{x:150,y:200},layersNum:60,angleVel:.08},waves:[{type:"sin",A:15,B:7,C:0,D:0},{type:"sin",A:14,B:6.5,C:0,D:0},{type:"sin",A:8,B:3,C:0,D:0}],modifiers:{nsIncrements:[.02,.025,.05],hue:1},sliders:{layersNum:{max:180,min:8},waveA:{max:100,min:.1,step:.1},waveB:{max:50,min:.01,step:.01},nIncr:{max:.2,min:0,step:1e-4},hue:{max:360,min:0,step:1}}};!function(){const t=document.querySelector("canvas");t.width=window.innerWidth,t.height=window.innerHeight;const e=t.getContext("2d");new p(e).init(g)}()}]);